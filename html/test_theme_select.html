<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>主题色选择器</title>
    <style>
      /* * CSS (样式)
         */

      /* 在 :root 中定义 CSS 变量，以便 JS 可以轻松更新它们 */
      :root {
        --theme-hue: 360; /* 默认色相 (360 对应图片中的粉红色) */

        /* --theme-hue 会被 JS 动态更新 */
        /* 我们基于这个色相定义几个颜色 */
        --theme-color: hsl(var(--theme-hue), 100%, 50%);
        --theme-color-light: hsl(var(--theme-hue), 100%, 92%);
        --theme-color-dark: hsl(var(--theme-hue), 70%, 40%);
      }

      body {
        display: grid;
        place-items: center;
        min-height: 100vh;
        background: #f0f2f5;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji",
          "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
      }

      .theme-color-picker {
        width: 300px;
        padding: 16px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        /* 模糊效果，模拟图片中的"毛玻璃"背景 */
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
      }

      .title {
        display: flex;
        align-items: center;
        font-size: 16px;
        font-weight: 600;
        color: #333;
      }

      /* 标题 "主题色" 旁边的彩色竖条 */
      .title::before {
        content: "";
        display: inline-block;
        width: 4px;
        height: 16px;
        border-radius: 2px;
        margin-right: 8px;
        background-color: var(--theme-color); /* 使用主题色 */
        transition: background-color 0.1s ease;
      }

      .reset-btn {
        display: grid;
        place-items: center;
        width: 28px;
        height: 28px;
        border: none;
        border-radius: 6px;
        font-size: 16px;
        cursor: pointer;
        background-color: var(--theme-color-light); /* 使用主题浅色 */
        color: var(--theme-color-dark); /* 使用主题深色 */
        transition: all 0.1s ease;
      }

      .reset-btn:hover {
        opacity: 0.8;
      }

      .slider-container {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .hue-value {
        width: 50px;
        height: 30px;
        padding: 0 8px;
        border: 1px solid #ddd;
        border-radius: 6px;
        text-align: center;
        font-size: 14px;
        box-sizing: border-box; /* 确保 padding 不会影响宽度 */
      }

      /* 移除 number input 的上下箭头 (仅 Webkit) */
      .hue-value::-webkit-outer-spin-button,
      .hue-value::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      /* (Firefox) */
      .hue-value[type="number"] {
        -moz-appearance: textfield;
      }

      .hue-value:focus {
        outline: none;
        border-color: var(--theme-color); /* 聚焦时使用主题色 */
        box-shadow: 0 0 0 2px var(--theme-color-light);
      }

      /* * 自定义滑块 (input[type="range"]) 样式 
         */
      .hue-slider {
        flex-grow: 1; /* 占据剩余空间 */
        -webkit-appearance: none; /* 移除默认样式 */
        appearance: none;
        width: 100%;
        height: 10px; /* 轨道高度 */
        background: linear-gradient(
          to right,
          hsl(0, 100%, 50%),
          hsl(60, 100%, 50%),
          hsl(120, 100%, 50%),
          hsl(180, 100%, 50%),
          hsl(240, 100%, 50%),
          hsl(300, 100%, 50%),
          hsl(360, 100%, 50%)
        ); /* 色相环渐变 */
        border-radius: 5px;
        outline: none;
        cursor: pointer;
      }

      /* 滑块的"滑块" (Chrome/Safari) */
      .hue-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 8px; /* 滑块宽度 */
        height: 22px; /* 滑块高度 */
        background: var(--theme-color-light); /* 使用主题浅色 */
        border: 2px solid var(--theme-color); /* 使用主题色边框 */
        border-radius: 4px;
        margin-top: -6px; /* 垂直居中 ( (22px - 10px) / 2 * -1 ) */
        transition: background-color 0.1s ease, border-color 0.1s ease;
      }

      /* 滑块的"滑块" (Firefox) */
      .hue-slider::-moz-range-thumb {
        width: 8px;
        height: 22px;
        background: var(--theme-color-light);
        border: 2px solid var(--theme-color);
        border-radius: 4px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="theme-color-picker">
      <div class="header">
        <span class="title">主题色</span>
        <button class="reset-btn" id="reset-button" title="重置">
          <span>&#x21BB;</span>
        </button>
      </div>

      <div class="slider-container">
        <input
          type="range"
          class="hue-slider"
          id="hue-slider"
          min="0"
          max="360"
          value="360"
        />

        <input
          type="number"
          class="hue-value"
          id="hue-value"
          min="0"
          max="360"
          value="360"
        />
      </div>
    </div>

    <script>
      /* * JavaScript (行为)
       */

      // 1. 获取所有需要操作的 DOM 元素
      const slider = document.getElementById("hue-slider");
      const valueInput = document.getElementById("hue-value");
      const resetButton = document.getElementById("reset-button");
      const root = document.documentElement; // HTML 的 <html> 根元素

      // 2. 创建一个函数来更新所有内容
      function updateThemeColor(hue) {
        // 确保 hue 是一个在 0-360 之间的数字
        let validHue = Math.min(Math.max(0, parseInt(hue)), 360);

        if (isNaN(validHue)) {
          validHue = 360; // 如果输入无效则重置
        }

        // 3. 更新 CSS 变量
        // JS 更新 :root 上的 --theme-hue 变量
        // CSS 会自动根据这个新变量重新渲染所有使用它的地方
        root.style.setProperty("--theme-hue", validHue);

        // 4. 同步滑块和输入框的值
        slider.value = validHue;
        valueInput.value = validHue;
      }

      // 5. 添加事件监听器

      // 当拖动滑块时
      slider.addEventListener("input", (event) => {
        updateThemeColor(event.target.value);
      });

      // 当在输入框中输入数字时
      valueInput.addEventListener("input", (event) => {
        updateThemeColor(event.target.value);
      });

      // 当点击重置按钮时
      resetButton.addEventListener("click", () => {
        updateThemeColor(360); // 重置回 360
      });

      // 6. 页面加载时，用默认值 360 初始化一次
      document.addEventListener("DOMContentLoaded", () => {
        updateThemeColor(360);
      });
    </script>
  </body>
</html>
